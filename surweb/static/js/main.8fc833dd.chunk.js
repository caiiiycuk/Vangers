(this.webpackJsonpsurweb=this.webpackJsonpsurweb||[]).push([[0],{10:function(e,_,n){"use strict";n.d(_,"f",(function(){return t})),n.d(_,"b",(function(){return r})),n.d(_,"d",(function(){return a})),n.d(_,"e",(function(){return c})),n.d(_,"a",(function(){return i})),n.d(_,"c",(function(){return s}));var t="thechain/mirage/world.ini",r="thechain/mirage/harmony.pal",a="thechain/mirage/output.vmp",c="thechain/mirage/output.vpr",i="bitmap/",s="shape3d/"},102:function(e,_,n){},130:function(e,_,n){},131:function(e,_,n){},132:function(e,_,n){"use strict";n.r(_);var t=n(0),r=n.n(t),a=n(11),c=n.n(a),i=(n(101),n(102),n(14)),s=n(5),o=n(6),l=n(18),u=n(15),b=n(13),d=(n(31),n(1));function p(e){var _=Object(t.useState)("mirage"),n=Object(s.a)(_,2),r=n[0],a=n[1],c=Object(t.useState)(10),i=Object(s.a)(c,2),l=i[0],u=i[1],b=Object(t.useState)(50),p=Object(s.a)(b,2),m=p[0],j=p[1],E=Object(t.useState)(2),h=Object(s.a)(E,2),M=h[0],P=h[1],f=Object(t.useState)(1),D=Object(s.a)(f,2),x=D[0],g=D[1],w=Object(t.useState)(O),v=Object(s.a)(w,2),R=v[0],T=v[1];return Object(d.jsx)("div",{children:Object(d.jsx)("div",{children:Object(d.jsxs)(o.c,{children:[Object(d.jsx)("h5",{children:"Generate World"}),Object(d.jsx)("p",{children:"Options"}),Object(d.jsxs)("div",{className:"open-inputs",children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("label",{className:"open-left-label",children:"Palette"}),Object(d.jsx)(o.g,{minimal:!1,options:["ark-a-znoy","boozeena","fostral","glorx","hmok","knox","necross","threall","weexow","xplo","mirage"],onChange:function(e){return a(e.currentTarget.value)},value:r})]}),Object(d.jsxs)("div",{className:"in-a-row",children:[Object(d.jsxs)("label",{className:"open-left-label",children:["World size (",l,")"]}),Object(d.jsx)(o.j,{className:"short-input",min:10,max:14,value:l,onValueChange:u})]}),Object(d.jsxs)("div",{className:"in-a-row",children:[Object(d.jsxs)("label",{className:"open-left-label",children:["Mesh Value (",m,")"]}),Object(d.jsx)(o.j,{className:"short-input",min:1,max:200,value:m,onValueChange:j})]}),Object(d.jsxs)("div",{className:"in-a-row",children:[Object(d.jsxs)("label",{className:"open-left-label",children:["Noise Amplitude (",M,")"]}),Object(d.jsx)(o.j,{className:"short-input",min:1,max:10,value:M,onValueChange:P})]}),Object(d.jsxs)("div",{className:"in-a-row",children:[Object(d.jsxs)("label",{className:"open-left-label",children:["Terain Type (",x,")"]}),Object(d.jsx)(o.j,{className:"short-input",min:0,max:7,value:x,onValueChange:g})]}),Object(d.jsx)("div",{children:Object(d.jsx)(o.b,{onClick:function(){var _="[Global Parameters]\nMap Power X=11\nMap Power Y=".concat(l,"\nGeoNet Power=6\nSection Size Power=8\nMinimal Square Power=4\n\n").concat(R,"\n\n[Creation Parameters]\nBuild Scenario File=output.vsc\nMesh Value=").concat(m,"\nNoise Amplitude=").concat(M,"\nDefault Terrain Type=").concat(x,"\n");e.openGen(r,_,l)},children:"Generate World"})}),Object(d.jsxs)("div",{children:[Object(d.jsx)("label",{className:"open-left-label",children:"Additional params"}),Object(d.jsx)("br",{}),Object(d.jsx)(o.n,{className:"open-textarea",large:!1,growVertically:!0,value:R,onChange:function(e){return T(e.target.value)}})]})]})]})})})}var O="[Storage]\nVersion=1.4\nCompressed Format Using=0\nFile Name=output\nPalette File=harmony.pal\n\n[Rendering Parameters]\nShadow Offsets= 6 16 4 9 6 3 2 6\nHeight Shifts=  2 4 8 8 5 6 8 6\nBegin Colors=   1 32 64 72 88 104 112 120\nEnd Colors=    31 63 71 87 103 111 119 127\n\n[Dynamic Palette]\nWave Terrain=0\nTerrain Number=3\nTerrains= 5 4 6\nSpeeds= 128 128 256\nAmplitudes= 32 8 32\nRed= 1 1 1\nGreen= 0 1 1\nBlue= 0 0 0\n\n[Lighting Cycle Dynamic Palette]\nWave Terrain=0\nTerrain Number=3\nTerrains= 5 4 6\nSpeeds= 128 128 256\nAmplitudes= 32 8 32\nRed= 1 1 1\nGreen= 0 1 1\nBlue= 0 0 0\n",m=n(8),j=n.n(m),E=n(12);function h(e){var _=Object(t.useState)(void 0),n=Object(s.a)(_,2),r=n[0],a=n[1],c=Object(t.useState)(!1),i=Object(s.a)(c,2),l=i[0],u=i[1];function b(){return(b=Object(E.a)(j.a.mark((function _(){var n;return j.a.wrap((function(_){for(;;)switch(_.prev=_.next){case 0:if(void 0!==r&&!l){_.next=2;break}return _.abrupt("return");case 2:return u(!0),_.next=5,M(r);case 5:n=_.sent,e.openZip(n);case 7:case"end":return _.stop()}}),_)})))).apply(this,arguments)}return Object(d.jsx)("div",{children:Object(d.jsxs)(o.c,{children:[Object(d.jsx)("h5",{children:"Restore world from ZIP"}),Object(d.jsxs)("p",{className:"try-zip",children:["Try (",Object(d.jsx)("a",{href:"worlds/satadi.zip",children:"satadi.zip"}),") OR (",Object(d.jsx)("a",{href:"worlds/empty.zip",children:"empty.zip"}),")"]}),Object(d.jsxs)("div",{className:"open-inputs",children:[Object(d.jsx)(o.f,{hasSelection:void 0!==r,text:r?r.name:"Select 'zip' File",onChange:function(e){a(e.target.files[0])}}),Object(d.jsx)(o.b,{disabled:!r||l,onClick:function(){return b.apply(this,arguments)},children:"Restore"})]})]})})}function M(e){return P.apply(this,arguments)}function P(){return(P=Object(E.a)(j.a.mark((function e(_){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.abrupt("return",new Promise((function(e,t){n.addEventListener("load",(function(_){e(new Uint8Array(n.result))})),n.readAsArrayBuffer(_)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){var _=Object(t.useState)(""),n=Object(s.a)(_,2),r=n[0],a=n[1];return Object(d.jsxs)("div",{className:"landing-menu",children:[Object(d.jsx)(o.i,{children:Object(d.jsxs)(o.i.Group,{align:l.a.LEFT,children:[Object(d.jsx)(o.i.Heading,{children:"SurWeb"}),Object(d.jsx)(o.i.Divider,{}),Object(d.jsx)(o.i.Heading,{children:Object(d.jsx)("a",{href:"https://caiiiycuk.github.io/vangers-web/",children:"vangers-web"})})]})}),Object(d.jsx)(o.d,{interactive:!0,elevation:u.a.TWO,children:Object(d.jsxs)("div",{className:"start-options",children:[Object(d.jsx)("div",{className:"open-option",children:Object(d.jsx)(o.a,{minimal:!0,intent:b.a.PRIMARY,onClick:function(){return e.openLastSession()},children:"Open SurWeb last session"})}),Object(d.jsx)("div",{className:"open-or",children:"OR"}),"gen"!==r?Object(d.jsx)("div",{className:"open-option",children:Object(d.jsx)(o.a,{intent:b.a.PRIMARY,minimal:!0,onClick:function(){return a("zip")},children:"Restore from ZIP"})}):null,Object(d.jsx)(o.e,{isOpen:"zip"===r,children:Object(d.jsx)(h,Object(i.a)({},e))}),Object(d.jsx)("div",{className:"open-or",children:"OR"}),"gen"!==r?Object(d.jsx)("div",{className:"open-option",children:Object(d.jsx)(o.a,{intent:b.a.PRIMARY,minimal:!0,onClick:function(){return a("gen")},children:"Generate world"})}):null,Object(d.jsx)(o.e,{isOpen:"gen"===r,children:Object(d.jsx)(p,Object(i.a)({},e))})]})})]})}var D=n(49);function x(){var e=Object(t.useState)(""),_=Object(s.a)(e,2),n=_[0],r=_[1],a=Object(t.useState)(null),c=Object(s.a)(a,2),o=c[0],l=c[1],u=Object(t.useState)(null),b=Object(s.a)(u,2),p=b[0],O=b[1],m={route:n,gen:o,openGen:function(e,_,n){l({palette:e,worldIni:_,size:n}),r("gen")},zip:p,openZip:function(e){O(e),r("zip")},openLastSession:function(){r("lastSession")},setVmp:function(e){},getVmp:function(){}};return n.length>0?Object(d.jsx)(D.a,Object(i.a)({},m)):Object(d.jsx)(f,Object(i.a)({},m))}c.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(x,{})}),document.getElementById("root"))},21:function(e,_,n){"use strict";n.d(_,"a",(function(){return c}));var t=n(8),r=n.n(t),a=n(12);function c(e,_){return i.apply(this,arguments)}function i(){return(i=Object(a.a)(r.a.mark((function e(_,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var r=new XMLHttpRequest;r.open("GET",_,!0),r.overrideMimeType("text/plain; charset=x-user-defined"),r.addEventListener("error",(function(e){t(new Error("Network error, can't download "+_))})),r.addEventListener("abort",(function(){t(new Error("Request canceled for url "+_))}),!1),r.responseType="arraybuffer",r.onreadystatechange=function(){4===r.readyState&&(200===r.status?(void 0!==n&&n(100),e(new Uint8Array(r.response))):t(new Error("Network error, can't download "+_)))},void 0!==n&&(r.onprogress=function(e){if(e.total&&e.total>0){var _=Math.round(1e4*e.loaded/e.total)/100;n(_)}}),r.send()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},31:function(e,_,n){},49:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return SurWeb}));var _home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8),_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__),_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(12),_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(18),_blueprintjs_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(13),react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__),_ron__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(50),_surweb_css__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(131),_surweb_css__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_surweb_css__WEBPACK_IMPORTED_MODULE_9__),_xhr__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(21),_config__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(10),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__),WIDTH=1280,HEIGHT=720;function SurWeb(e){var _=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)({})[0],n=Object(react__WEBPACK_IMPORTED_MODULE_7__.useRef)(null),t=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(null),r=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(t,2),a=r[0],c=r[1],i=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(0),s=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(i,2),o=s[0],l=s[1],u=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(null),b=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(u,2),d=b[0],p=b[1],O=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(!1),m=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(O,2),j=m[0],E=m[1],h=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(null),M=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(h,2),P=M[0],f=M[1],D=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(0),x=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(D,2),g=x[0],w=x[1],v=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(null),R=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(v,2),T=R[0],A=R[1],C=Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(!1),L=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(C,2),U=L[0],I=L[1];function W(e){null!==P&&URL.revokeObjectURL(P);var _=new Blob([e],{type:"application/zip"}),n=URL.createObjectURL(_);f(n)}return Object(react__WEBPACK_IMPORTED_MODULE_7__.useEffect)((function(){function e(){return(e=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark((function e(){var _,n,t,r,a,c;return _home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Object(_xhr__WEBPACK_IMPORTED_MODULE_10__.a)("surmap/bin.data.js",l),Object(_xhr__WEBPACK_IMPORTED_MODULE_10__.a)("surmap/bin.data",l),Object(_xhr__WEBPACK_IMPORTED_MODULE_10__.a)("surmap/surmap.wasm"),Object(_xhr__WEBPACK_IMPORTED_MODULE_10__.a)("surmap/surmap.js")]);case 2:_=e.sent,n=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_,4),t=n[0],r=n[1],a=n[2],c=n[3],p({dataJs:t,data:r,wasm:a,wasmJs:c});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch(console.error)}),[]),Object(react__WEBPACK_IMPORTED_MODULE_7__.useEffect)((function(){if(null!==n.current){var e=n.current,_=e.parentElement.getBoundingClientRect();c(e),e.width=WIDTH,e.height=HEIGHT,resizeCanvas(e,_.width,_.height)}}),[n]),Object(react__WEBPACK_IMPORTED_MODULE_7__.useEffect)((function(){null!==a&&null!==d&&instantiateWasm(a,d,_,W,e).then((function(){return E(!0)})).catch(console.error)}),[a,d,_]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"surweb-container",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.i,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.i.Group,{align:_blueprintjs_core__WEBPACK_IMPORTED_MODULE_5__.a.LEFT,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.i.Heading,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.a,{intent:_blueprintjs_core__WEBPACK_IMPORTED_MODULE_6__.a.PRIMARY,minimal:!0,onClick:function(){return window.location.reload()},children:"SurWeb"})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.i.Divider,{}),j?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"file-container",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.f,{disabled:null!==T,text:"Add file",onInputChange:function(e){null===a||void 0===a||a.focus();var n=e.currentTarget.files;if(0!==n.length){var t=n[0],r=new FileReader;r.addEventListener("load",function(){var e=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark((function e(n){var a,c,i;return _home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Uint8Array(r.result),c=_.FS,i=c.cwd()+"/",t.name.endsWith(".bmp")||t.name.endsWith(".pal")){try{c.unlink(i+_config__WEBPACK_IMPORTED_MODULE_11__.a+t.name)}catch(n){}c.createDataFile(i,_config__WEBPACK_IMPORTED_MODULE_11__.a+t.name,a,!0,!0,!0),c.syncfs((function(e){})),alert("Ok")}else if(t.name.endsWith(".c3d")){try{c.unlink(i+_config__WEBPACK_IMPORTED_MODULE_11__.c+t.name)}catch(s){}c.createDataFile(i,_config__WEBPACK_IMPORTED_MODULE_11__.c+t.name,a,!0,!0,!0),c.syncfs((function(e){})),alert("Ok")}else alert("Only bmp / c3d / pal files are supported");A(null);case 5:case"end":return e.stop()}}),e)})));return function(_){return e.apply(this,arguments)}}()),r.addEventListener("progress",(function(e){return w(e.loaded/e.total)})),r.readAsArrayBuffer(t),A(r)}else A(null)}}),"\xa0\xa0",Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.m,{size:16,intent:_blueprintjs_core__WEBPACK_IMPORTED_MODULE_6__.a.PRIMARY,value:g})]}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.i.Heading,{children:["Loading ",o,"%"]}),j?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.b,{minimal:!0,onKeyDown:function(){},onClick:function(){return I(!U)},children:"RON"}):null,null!==P?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.b,{intent:_blueprintjs_core__WEBPACK_IMPORTED_MODULE_6__.a.PRIMARY,onKeyDown:function(){},minimal:!0,onClick:function(){null===a||void 0===a||a.focus(),null!==P&&downloadUrl(P)},children:"Download ZIP"}):null]})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.l,{onResize:function(e){null!==a&&resizeCanvas(a,e[0].contentRect.width,e[0].contentRect.height)},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsxs)("div",{className:"canvas-container",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("canvas",{id:"canvas",ref:n,tabIndex:0}),j?null:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{className:"spinner-container",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.m,{size:64})})]})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_4__.k,{isOpen:U,lazy:!0,hasBackdrop:!1,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)(_ron__WEBPACK_IMPORTED_MODULE_8__.a,Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)(Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.a)({},e),{},{Module:_,close:function(){return I(!1)}}))})]})}function instantiateWasm(e,_,n,t,r){return new Promise((function(a,c){try{n.saveZip=function(e){n.FS.syncfs((function(e){})),t(e)},n.canvas=e,n.instantiateWasm=function(){var e=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark((function e(n,t){var r,a;return _home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,WebAssembly.compile(_.wasm);case 2:return r=e.sent,e.next=5,WebAssembly.instantiate(r,n);case 5:a=e.sent,t(a,r);case 7:case"end":return e.stop()}}),e)})));return function(_,n){return e.apply(this,arguments)}}(),n.onRuntimeInitialized=function(){instantiateProps(n,r,_).then((function(e){setTimeout((function(){n.callMain(e),a()}),16)})).catch(console.error)};var i=new TextDecoder;new Function(["Module"],i.decode(_.wasmJs))(n)}catch(s){c(s)}}))}function instantiateProps(Module,props,binaries){return new Promise((function(resolve,reject){Module.FS.chdir("/idbfs"),Module.FS.syncfs(!0,(function(err){var root=Module.FS_cwd()+"/";try{Module.FS.lookupPath(root+_config__WEBPACK_IMPORTED_MODULE_11__.f)}catch(e){Module.getPreloadedPackage=function(e,_){return binaries.data.buffer},eval((new TextDecoder).decode(binaries.dataJs)),Module.FS.syncfs((function(){}))}if("gen"===props.route&&null!==props.gen){window.m=Module;var enc=new TextEncoder;if(Module.FS.unlink(root+_config__WEBPACK_IMPORTED_MODULE_11__.f),Module.FS.createDataFile(root,_config__WEBPACK_IMPORTED_MODULE_11__.f,enc.encode(props.gen.worldIni),!0,!0,!0),"mirage"!==props.gen.palette){Module.FS.unlink(root+_config__WEBPACK_IMPORTED_MODULE_11__.b);var data=Module.FS.readFile(root+"_palette/"+props.gen.palette+".pal");Module.FS.createDataFile(root,_config__WEBPACK_IMPORTED_MODULE_11__.b,data,!0,!0,!0)}resolve(["/I"+props.gen.size,"/G0"])}else if("zip"===props.route&&null!==props.zip){Module.FS.chdir(root+"thechain/mirage/");var bytes=props.zip,buffer=Module._malloc(bytes.length);Module.HEAPU8.set(bytes,buffer),Module._zip_to_fs(buffer,bytes.length),Module._free(buffer),Module.FS.chdir(root),resolve([])}else resolve([])}))}))}function resizeCanvas(e,_,n){var t=getSizeWithAspectRatio(_,n,WIDTH/HEIGHT),r=Object(_home_caiiiycuk_gamepix_games_vangers_web_surweb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(t,2),a=r[0],c=r[1];e.style.position="relative",e.style.top=n/2+"px",e.style.left=_/2+"px",e.style.marginTop=c/2*-1+"px",e.style.marginLeft=a/2*-1+"px",e.style.width=a+"px",e.style.height=c+"px"}function getSizeWithAspectRatio(e,_,n){if(e/_===n)return[e,_];var t=Math.round(_*n);return t<=e?[t,_]:[e,Math.round(e/n)]}function downloadUrl(e){var _=document.createElement("a");_.href=e,_.download="world.zip",_.style.display="none",document.body.appendChild(_),_.click(),_.remove()}},50:function(e,_,n){"use strict";n.d(_,"a",(function(){return u}));var t=n(8),r=n.n(t),a=n(12),c=n(5),i=n(6),s=n(0),o=n(10),l=(n(130),n(1));function u(e){var _=Object(s.useState)(void 0),n=Object(c.a)(_,2),t=n[0],u=n[1],d=Object(s.useState)(void 0),O=Object(c.a)(d,2),m=O[0],j=O[1],E=Object(s.useState)(void 0),h=Object(c.a)(E,2),M=h[0],P=h[1],f=Object(s.useState)(void 0),D=Object(c.a)(f,2),x=D[0],g=D[1],w=Object(s.useState)(!1),v=Object(c.a)(w,2),R=v[0],T=v[1],A=Object(s.useState)(""),C=Object(c.a)(A,2),L=C[0],U=C[1],I=Object(s.useState)(""),W=Object(c.a)(I,2),y=W[0],B=W[1],K=Object(s.useState)(""),k=Object(c.a)(K,2),S=k[0],N=k[1],F=Object(s.useState)(""),z=Object(c.a)(F,2),G=z[0],q=z[1];function H(e,_){_(e.target.files[0])}function V(){return(V=Object(a.a)(r.a.mark((function _(){var n,a,c,i,s,l,u,d;return r.a.wrap((function(_){for(;;)switch(_.prev=_.next){case 0:if(t&&m&&M&&x){_.next=2;break}return _.abrupt("return");case 2:return T(!0),_.next=5,b(t);case 5:return n=_.sent,_.next=8,b(m);case 8:return a=_.sent,_.next=11,b(M);case 11:return c=_.sent,_.next=14,b(x);case 14:i=_.sent,s=ron2vmp(n,a,c,i),l=e.Module,u=l.FS,d=u.cwd()+"/",u.unlink(d+o.d),u.createDataFile(d,o.d,s,!0,!0,!0),l._reloadWorld(),l._updateZipArchive(),T(!1),e.close();case 25:case"end":return _.stop()}}),_)})))).apply(this,arguments)}function Z(){return(Z=Object(a.a)(r.a.mark((function _(){return r.a.wrap((function(_){for(;;)switch(_.prev=_.next){case 0:T(!0),setTimeout((function(){var _=e.Module,n=_.FS;_._updateZipArchive();var t=n.cwd()+"/",r=(new TextDecoder).decode(n.readFile(t+o.f)),a=n.readFile(t+o.d),c=n.readFile(t+o.e),i=n.readFile(t+o.b);vmp2ron(r,a,c,i);var s=get_ron_multi_png(),l=get_height_png(),u=get_material_hi_png(),b=get_material_lo_png();L.length>0&&(URL.revokeObjectURL(L),URL.revokeObjectURL(y),URL.revokeObjectURL(S),URL.revokeObjectURL(G)),U(URL.createObjectURL(new Blob([s],{type:"text"}))),B(URL.createObjectURL(new Blob([l],{type:"image/png"}))),N(URL.createObjectURL(new Blob([u],{type:"image/png"}))),q(URL.createObjectURL(new Blob([b],{type:"image/png"}))),console.log(s,l,u,b),T(!1)}),100);case 2:case"end":return _.stop()}}),_)})))).apply(this,arguments)}return Object(l.jsxs)(i.d,{children:[Object(l.jsxs)("div",{className:"ron-container",children:[Object(l.jsx)("div",{children:R?Object(l.jsx)(i.m,{}):Object(l.jsxs)(i.c,{children:[Object(l.jsx)("h5",{children:"Export WROLD to RON"}),Object(l.jsxs)("div",{className:"open-inputs",children:[L.length>0?Object(l.jsx)(i.b,{className:"ron-download",onKeyDown:function(){},minimal:!0,onClick:function(){return p(L,"world.ron")},children:"Download RON"}):null,y.length>0?Object(l.jsx)(i.b,{className:"ron-download",onKeyDown:function(){},minimal:!0,onClick:function(){return p(y,"height.png")},children:"Download height PNG"}):null,S.length>0?Object(l.jsx)(i.b,{className:"ron-download",onKeyDown:function(){},minimal:!0,onClick:function(){return p(S,"material_hi.png")},children:"Download material HI PNG"}):null,G.length>0?Object(l.jsx)(i.b,{className:"ron-download",onKeyDown:function(){},minimal:!0,onClick:function(){return p(G,"material_lo.png")},children:"Download material LO PNG"}):null,Object(l.jsx)(i.b,{onClick:function(){return Z.apply(this,arguments)},children:"Export world"})]})]})}),Object(l.jsx)("div",{children:R?Object(l.jsx)(i.m,{}):Object(l.jsxs)(i.c,{children:[Object(l.jsx)("h5",{children:"Update WORLD using RON"}),Object(l.jsx)("p",{children:"Provide files"}),Object(l.jsxs)("div",{className:"open-inputs",children:[Object(l.jsx)(i.f,{hasSelection:void 0!==t,text:t?t.name:"Select 'ron' File",onInputCapture:function(e){return H(e,u)}}),Object(l.jsx)(i.f,{hasSelection:void 0!==m,text:m?m.name:"Select 'height' File",onInputCapture:function(e){return H(e,j)}}),Object(l.jsx)(i.f,{hasSelection:void 0!==M,text:M?M.name:"Select 'material_hi' File",onInputCapture:function(e){return H(e,P)}}),Object(l.jsx)(i.f,{hasSelection:void 0!==x,text:x?x.name:"Select 'material_lo' File",onInputCapture:function(e){return H(e,g)}}),Object(l.jsx)(i.b,{disabled:!(t&&m&&M&&x),onClick:function(){return V.apply(this,arguments)},children:"Update world"})]})]})}),Object(l.jsx)(i.h,{className:"ron-close",icon:"cross",onClick:function(){return e.close()}})]}),Object(l.jsxs)("div",{className:"ron-powered-by",children:["Powered by ",Object(l.jsx)("a",{rel:"noreferrer",href:"https://github.com/kvark/vange-rs/wiki/Resource-Converter",target:"_blank",children:"vanger-rs converter"})]})]})}function b(e){return d.apply(this,arguments)}function d(){return(d=Object(a.a)(r.a.mark((function e(_){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.abrupt("return",new Promise((function(e,t){n.addEventListener("load",(function(_){e(new Uint8Array(n.result))})),n.readAsArrayBuffer(_)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,_){var n=document.createElement("a");n.href=e,n.download=_,n.style.display="none",document.body.appendChild(n),n.click(),n.remove()}}},[[132,1,2]]]);
//# sourceMappingURL=main.8fc833dd.chunk.js.map